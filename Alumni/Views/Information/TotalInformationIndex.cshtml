
@{
    ViewBag.Title = "TotalInformationIndex";
}
<head>
    <title>校友联络信息</title>    
</head>
<body>
    <h2>校友联络信息</h2><br />
    <div>
        <div class="d-flex mb-2">
            <hr>
            <span class="item-title">学生手机号/学生学号</span>
            <input ID="Stu_Empno" name="Stu_Empno" runat="server" class="col-sm-12 col-md-6 col-xl-2" />
            <button id="btn_search" type="button" class="btn btn-primary ms-2">搜索</button>
            <button id="btn_export" class="btn btn-info ms-2" data-table="#table" type="button">下载汇出</button>
        </div>
        <table id="table"></table>
    </div>
</body>
<script src="~/static/js/bootstrap.min.js" data-cf-settings="4bebc94b2db97a1f9680a39f-|49" defer=""></script>
<script src="~/static/js/bootstrap-table.js" data-cf-settings="4bebc94b2db97a1f9680a39f-|49" defer=""></script>
<script type="text/javascript">
    $(function () {
        var $table = $("#table");
        $('#table').bootstrapTable('destroy');
        $('#table').bootstrapTable({
                    ajax: function (request) {
                        var model = {
                            "Stu_Empno": $("#Stu_Empno").val(),
                        }
                        request.data = model;
                        $.ajax({
                            type: "post",
                            url:"@(Url.Action("GetInformationData", "Information"))",
                            contentType: "application/json;charset=UTF-8",
                            data: JSON.stringify(request.data),
                            dataType: "json",
                            jsonp: 'callback',
                            success: function (msg) {
                                request.success({
                                    rows: msg
                                });
                                $('#table').bootstrapTable('load', msg);
                            },
                            error: function () {
                                alert("错误");
                            }
                        });
                    },
                    toolbar: '#toolbar',
                    singleSelect: true,
                    clickToSelect: true,
                    sortName: "CreateTime",
                    sortOrder: "desc",
                    cache: false,
                    striped: true,
                    pageSize: 10,
                    pageNumber: 1,
                    pageList: "[15, 25, 50, 100, All]",
                    showToggle: true,
                    showRefresh: true,
                    showColumns: true,
                    search: true,
                    pagination: true,
                    columns: [
                    {
                        field: "InchSeqNo",
                        visible: false,
                    },
                    {
                        field: 'Form_Name',
                        title: '单据名称',
                        switchable: true
                    },{
                        field: 'LatestPhoto',
                        title: '近照',
                        events: 'operateEvents',
                        formatter: function (value, row, index) {
                            var url = "..";
                            var s = '<a class="view">' +
                                '<img style="width:80px;height:80px;"  src="'+ url + value + '" />' +
                                '</a>';
                            return s;
                        }
                    },{
                        field: 'Stu_Empno',
                        title: '学号',
                        switchable: true
                    }, {
                        field: 'Stu_Name',
                        title: '中文名',
                        switchable: true,
                        sortable: true
                    },{
                        field: 'Stu_Eame',
                        title: '英文名',
                        switchable: true,
                        sortable: true
                    },{
                        field: 'GraduationStatus',
                        title: '是否在G12从康桥毕业',
                        switchable: true
                    },{
                        field: 'College',
                        title: '就读院校',
                        switchable: true
                    },{
                        field: 'Email',
                        title: '邮箱地址',
                        switchable: true
                    },{
                        field: 'WeChat',
                        title: '微信账号',
                        switchable: true
                    },{
                        field: 'NewPhone',
                        title: '电话号码',
                        switchable: true
                    },{
                        field: 'WillJoin',
                        title: '是否愿意加入康桥校友会',
                        switchable: true
                    },{
                        field: 'CreateTime2',
                        title: '提交时间',
                        switchable: true
                    }],
        });

        //window.operateEvents = {
        //    'click .view': function (e, value, row, index) {
        //        var url = row.iconUrl;
        //        layer.open({
        //            type: 1,
        //            title: false,
        //            closeBtn: 0,
        //            area: ['60%', '100%'],
        //            skin: 'layui-layer-nobg', //没有背景色
        //            shadeClose: true,
        //            content: '<img style="width: 100%;height: 100%" src="' + url + '"/>'
        //        });
        //    },
        //};

        $('#btn_export').click(function () {
            var Stu_Empno = $("#Stu_Empno").val();
            var url = "@(Url.Action("InformationExport", "Information"))" + "?Stu_Empno=" + Stu_Empno;
            window.location = url;
        });

        $('#btn_search').click(function () {
            $('#table').bootstrapTable('refresh', { pageNumber: 1 });
        });

    });
</script>

